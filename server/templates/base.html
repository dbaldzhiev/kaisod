<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kais Monitor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}" />
    <script defer src="{{ url_for('static', filename='main.js') }}"></script>
  </head>
  <body>
    <header class="top-bar">
      <h1><a href="{{ url_for('dashboard') }}">Kais Monitor</a></h1>
      <nav>
        <a href="{{ url_for('dashboard') }}">Dashboard</a>
        <a href="{{ url_for('items') }}">Items</a>
        <a href="{{ url_for('monitored_items') }}">Monitored</a>
        <a href="{{ url_for('settings') }}">Settings</a>
        <a href="{{ url_for('export_csv') }}">Export CSV</a>
        <a href="{{ url_for('export_json') }}">Export JSON</a>
      </nav>
    </header>
    <div
      id="scan-status-banner"
      class="scan-status-banner {{ 'running' if scan_status.status == 'running' else 'idle' }}"
      data-running="{{ 1 if scan_status.status == 'running' else 0 }}"
    >
      <span class="label">Scan:</span>
      <span class="message" data-role="message">{{ scan_status.progress.message }}</span>
      <span class="counts" data-role="counts">
        {% if scan_status.progress.total %}
          {{ scan_status.progress.processed }}/{{ scan_status.progress.total }}
        {% endif %}
      </span>
      <span class="path" data-role="path">{{ scan_status.progress.current_path or '' }}</span>
    </div>
    <main>
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <ul class="flashes">
            {% for category, message in messages %}
              <li class="{{ category }}">{{ message }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </main>
    <footer>
      <small>
        Internal tool â€¢ Last scan:
        {{ scan_status.last_scan_at | format_datetime }}
      </small>
    </footer>
  </body>
</html>
